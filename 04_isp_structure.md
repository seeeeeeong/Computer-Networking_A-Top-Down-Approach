# 1.4 패킷 교환 네트워크에서의 지연, 손실과 처리율

인터넷은 여러 컴퓨터(종단 시스템)들이 서로 데이터를 주고받을 수 있게 하는 네트워크입니다.  
이때, 데이터가 잘 전달되길 바라지만 현실에서는 여러 한계 때문에 지연이 생기고, 데이터가 손실되기도 하며, 전송할 수 있는 데이터 양(처리율)도 제한됩니다.

---

## 1.4.1 패킷 교환 네트워크에서의 지연

패킷은 출발지 컴퓨터에서 시작해 여러 라우터를 거쳐 목적지 컴퓨터로 전달됩니다.  
패킷이 라우터 하나를 통과할 때마다 여러 종류의 지연이 발생하며, 이 지연들이 쌓여서 전체 전송 시간이 됩니다.

### 1) 지연의 종류

| 지연 종류          | 설명                                      | 예시/특징                           |
|-----------------|-----------------------------------------|----------------------------------|
| 처리 지연 (Processing delay) | 라우터가 패킷 헤더를 읽고 전송 경로를 결정하는 데 걸리는 시간 | 보통 매우 짧음 (수 마이크로초)         |
| 큐잉 지연 (Queuing delay)    | 패킷이 전송 대기열(버퍼)에서 대기하는 시간           | 트래픽이 많으면 길어지고, 없으면 거의 0      |
| 전송 지연 (Transmission delay) | 패킷을 링크에 모두 올리는 데 걸리는 시간              | 패킷 크기와 링크 속도에 따라 결정 (패킷 크기 ÷ 링크 속도) |
| 전파 지연 (Propagation delay) | 비트가 물리적 매체를 따라 전파되는 데 걸리는 시간       | 거리 ÷ 전파 속도 (빛의 속도 근처)     |

---

### 2) 전송 지연 vs 전파 지연 비교

- **전송 지연**은 *패킷 크기*와 *링크 속도*에 영향받음  
- **전파 지연**은 *거리*와 *전파 속도*에 영향받음  
- 예를 들어, 패킷이 크고 링크가 느리면 전송 지연이 커지고, 거리가 멀면 전파 지연이 커집니다.

---

### 3) 전체 노드 지연 공식

한 라우터를 지나는 데 걸리는 시간은 다음을 모두 더한 값입니다.

전체 노드 지연 = 처리 지연 + 큐잉 지연 + 전송 지연 + 전파 지연

---

## 1.4.2 큐잉 지연과 패킷 손실

### 1) 큐잉 지연은 왜 다를까?

- 패킷이 동시에 많이 도착하면, 먼저 온 패킷들이 전송될 때까지 기다려야 합니다.  
- 그래서 같은 노드라도 패킷마다 큐잉 지연이 다를 수 있습니다.

### 2) 트래픽 강도 (Traffic Intensity)

- 트래픽 강도란 "도착하는 데이터 양"과 "전송 가능한 데이터 양"의 비율입니다.

트래픽 강도 = (패킷 크기 × 초당 도착 패킷 수) ÷ 링크 전송률

- 예를 들어, 패킷 크기가 L 비트이고, 초당 a개의 패킷이 도착하며, 링크 속도가 R 비트/초라면

트래픽 강도 = (L × a) / R

### 3) 트래픽 강도에 따른 큐잉 지연

- 트래픽 강도가 1보다 크면(즉, (L × a) / R > 1), 도착하는 데이터가 전송 가능한 양보다 많아서 큐가 무한히 커지고 지연이 계속 늘어납니다 → 네트워크 과부하 상태  
- 트래픽 강도가 1 이하거나 같으면 정상 상태이고, 큐잉 지연은 도착 패턴에 따라 달라집니다.

### 4) 패킷 손실

- 실제 큐는 용량이 제한되어 있어서 꽉 차면 새로운 패킷을 버립니다(drop).  
- 트래픽이 많으면 손실 확률도 커지며, 손실된 패킷은 다시 전송됩니다.

---

## 1.4.3 종단 간 지연 (End-to-End Delay)

출발지에서 목적지까지 N-1개의 라우터가 있다고 할 때, 각 라우터의 지연을 모두 합하면 종단 간 지연이 됩니다.

종단 간 지연 = N × (처리 지연 + 전송 지연 + 전파 지연)

큐잉 지연은 네트워크 상태에 따라 다르므로 여기서는 무시합니다.

---

## 1.4.4 컴퓨터 네트워크에서 처리율 (Throughput)

### 1) 처리율이란?

- 단위 시간당 전송되는 데이터 양 (비트/초)  
- 예를 들어, 10초 동안 1000비트를 전송하면 처리율은 100비트/초

### 2) 처리율의 제한 요소

- 데이터는 여러 링크를 거치는데, 가장 느린 링크가 병목이 됩니다.

### 3) 병목 링크에 따른 처리율

링크 속도가 각각 R1, R2, ..., RN이면

처리율 = 가장 느린 링크 속도(minimum of R1, R2, ..., RN)

---

### 4) 실제 인터넷 예시

- 서버-라우터 링크 속도: Rs  
- 라우터-클라이언트 링크 속도: Rc

처리율 = Rs 와 Rc 중 더 느린 쪽

---

### 5) 여러 사용자가 동시에 다운로드 할 때

- 코어 링크 속도: R  
- 10명이 동시에 다운로드 한다면, 각 사용자 처리율은

처리율 = Rs, Rc, 그리고 코어 링크 속도 R 나누기 10 중 가장 작은 값

즉, min(Rs, Rc, R/10)

---
